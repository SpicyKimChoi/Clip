# 2020 01 20
* 어제에 이어서 도커 작업중...

## docker ~ing
어제에 이어서 도커 작업중이라고 적었지만 작업도중 00시가 지났기 때문에 새로 파일을 만들어주었다. 

클라이언트쪽 하는 것 구경하다가 시간이 조금 지나게 되었다. 

여러 글들을 보면서 서로 제각각 방법들이 있는데 일단 cli를 사용하는 방법보다 docker-compose.yml을 사용하고 싶었다. (사실 이 파일이 정확히 뭔지는 모르지만 될 것 같다는 근거없는 생각에 진행중이다. 하다보면 뭐라도 나오겠지...) 파일을 통해서 실행한다면 다른 실행환경에서 (배포) 진행할 때 다시 명령어를 찾지 않아도 될 것 같아서 이렇게 진행하려 한다. 

일단 방향은 맞는것 같다, cli를 통해서 할 때 역시 links를 사용해주고 docker-compose.yml파일을 통해서도 가능하다는 글을 읽었다. (근데 왜 안되냐고)

계속 `Error: connect ECONNREFUSED 127.0.0.1:3306 at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1144:16)` 요런 에러가 뜬다... 127.0.0.1이 문제인것 같긴한데 host를 바꿔봐도 저 주소는 바뀌지 않았다.. 뭐가 문젤까?

`docker exec -i -t server_mysql_1 bash`명령어를 통해 도커 mysql에 들어갔다. 정상적으로 들어간다!! 심지어 clip이라는 데이터베이스도 생성이 되어있었다. 연결만 되면 되는데!!연결이 안된다.

`docker exec -t server_node_1 cat /etc/hosts` 이 명령어를 통해서 서버 컨테이너에 연결된 링크가 있는지 확인했다. 데이터베이스 컨테이너와 연결이 되어있지 않았다. 

계속 되지 않았다. docker-compose version이 3이상인 경우 links를 따로 명시하지 않아도 된다고 해서 지워보기도 하고, 컨테이너 이름도 변경해봤지만 항상 같은 문제였다. 아직 뭐가 문젠지는 잘 모르겠다. 

포트를 바꿔보았다. 에러로그에 변경한 포트가 보이지 않는다는 것을 알게되었다. 추후에 이 점을 가지고 (ormconfig.ts가 문제일 수 도 있겠다는 생각이 들었다.) 다시 시도해봐야겠다.