# 2021 01 16

* 회원탈퇴 기능
* 로그아웃 기능 



## 회원탈퇴 기능

해당 API로 요청이 왔을 때 유저를 데이터베이스에서 지우는 API이다. 로그인한 사람이 자신의 정보를 지우는데 사용해야하므로 jwt로 생성한 토큰이 있는지 확인해야한다. 

포스트맨으로 쿠키를 받아오는지 확인하기 위해 테스트해봤지만 잘 안됬다. 로그인은 되지만 포스트맨에서 쿠키를 보내지 못하는 것으로 보였다.

request를 전부 까서 확인해보니 헤더에 쿠키가 정상적으로 들어오는 것을 확인했다. `cookie-parser`미들웨어가 없어서 발생한 문제였다. 해결되었다. 

이제 쿠키에서 uuid를 받아오는데 성공했다. `verify` 의 콜백함수 매개변수의 타입이 아직 any다 이 타입을 찾아봐야한다. error의 타입은 never로, decoded의 매개변수는 {id: string}으로 선언해주었다. decoded는 object타입이라 object를 처음에 넣어주었지만 에러가 발생했다. 객체의 경우 내부의 타입까지 지정해줘야 하는 것을 알게되었다. 

정상적으로 회원탈퇴되는 것을 확인했다. 다음에 project를 만든 뒤 해당 유저를 지우면 그 프로젝트도 삭제되는지 확인해봐야겠다. (어드민 권한인 경우, 프로젝트에 한명뿐인 어드민이 계삭한 경우에 대해서 팀원과 논의해봐야겠다. )

## 로그아웃 기능

회원탈퇴기능을 구현하면서 토큰에 접근하는 방법과 redirect하는 방법을 알았기 때문에 바로 만들어주었다.